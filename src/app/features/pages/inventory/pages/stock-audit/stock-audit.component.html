<div class="p-6 space-y-6">
  <div class="bg-white p-6 rounded-3xl border border-border shadow-sm flex flex-wrap gap-4 items-end">
    <div class="flex-1 min-w-[200px]">
      <label class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Select Product</label>
      <select [(ngModel)]="selectedProduct" (change)="fetchAudit()" class="w-full mt-2 p-3 bg-gray-50 border border-border rounded-xl outline-none">
        @for (p of products(); track p.id) { <option [value]="p.id">{{ p.name }}</option> }
      </select>
    </div>

    <div class="flex-1 min-w-[200px]">
      <label class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Select Branch</label>
      <select [(ngModel)]="selectedBranch" (change)="fetchAudit()" class="w-full mt-2 p-3 bg-gray-50 border border-border rounded-xl outline-none">
        @for (b of branches(); track b.id) { <option [value]="b.id">{{ b.name }}</option> }
      </select>
    </div>
  </div>

  <div class="bg-white rounded-3xl border border-border overflow-hidden shadow-sm">
    <table class="w-full text-left">
      <thead class="bg-gray-50 border-b">
        <tr>
          <th class="p-4 text-xs font-bold text-gray-400 uppercase">Date & Time</th>
          <th class="p-4 text-xs font-bold text-gray-400 uppercase">Type</th>
          <th class="p-4 text-xs font-bold text-gray-400 uppercase text-center">Change</th>
          <th class="p-4 text-xs font-bold text-gray-400 uppercase text-center">Final Balance</th>
          <th class="p-4 text-xs font-bold text-gray-400 uppercase">Actor</th>
        </tr>
      </thead>
      <tbody class="divide-y">
        @for (log of auditLogs(); track log.id) {
          <tr class="hover:bg-gray-50 transition-colors">
            <td class="p-4 text-sm text-gray-600">{{ log.created_at | date:'medium' }}</td>
            <td class="p-4">
              <span class="px-2 py-1 rounded-md text-[10px] font-bold uppercase"
                [ngClass]="{
                  'bg-green-100 text-green-700': log.type === 'PURCHASE' || log.type === 'RESTOCK',
                  'bg-red-100 text-red-700': log.type === 'SALE' || log.type === 'WASTE',
                  'bg-blue-100 text-blue-700': log.type === 'TRANSFER'
                }">
                {{ log.type }}
              </span>
            </td>
            <td class="p-4 text-center font-mono font-bold" [class.text-green-600]="log.quantity_change > 0" [class.text-red-600]="log.quantity_change < 0">
              {{ log.quantity_change > 0 ? '+' : '' }}{{ log.quantity_change }}
            </td>
            <td class="p-4 text-center font-black text-store-brown">{{ log.balance_after }}</td>
            <td class="p-4 text-xs text-gray-500">{{ log.user?.employee?.name ?? log.user?.username }}</td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>